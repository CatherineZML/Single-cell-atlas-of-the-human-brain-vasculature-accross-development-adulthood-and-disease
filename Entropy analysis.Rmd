---
title: "Entropy analysis"
author: "Moheb Ghobrial"
output: html_notebook
---



```{r}

library(SCENT)
library(Seurat)
library(scater)

seurat <- readRDS(file = "seurat.rds")

counts <- as.matrix(MERGE@assays[["RNA"]]@data)
range(counts.m)

#[1] 0.1375035 3.3477537


require(AnnotationDbi)
require(org.Hs.eg.db)
anno.v <- mapIds(org.Hs.eg.db, keys = rownames(counts.m), keytype = "SYMBOL", 
                 column = "ENTREZID", multiVals = "first")
unique_anno.v <- unique(anno.v)
example_New.m <- matrix(0, nrow = length(unique_anno.v), ncol = dim(counts.m)[2])
for (i in seq_len(length(unique_anno.v))) {
  tmp <- counts.m[which(anno.v == unique_anno.v[i]) ,]
  if (!is.null(dim(tmp))) {
    tmp <- colSums(tmp) / dim(tmp)[1]
  }
  example_New.m[i ,] <- example_New.m[i ,] + tmp
}
rownames(example_New.m) <- unique_anno.v
colnames(example_New.m) <- colnames(counts.m)
example_New.m <- example_New.m[-which(rownames(example_New.m) %in% NA) ,]


Example.m <- example_New.m

#prepare medadata
metadata <- as.data.frame(as.matrix(seurat@meta.data))
library(dplyr)


ccat.v <- CompCCAT(exp = Example.m, ppiA = net13Jun12.m)
boxplot(ccat.v ~ metadata.v, main = "SR potency estimates", xlab = "Cell Type", ylab = "SR")


```


